#!/usr/bin/env node

/**
 * 国連海洋法条約(UNCLOS)のYAMLファイルにタイトルを追加するスクリプト
 *
 * 使用方法:
 *   node scripts/tools/update-unclos-titles.cjs
 */

const fs = require('fs');
const path = require('path');
const yaml = require('js-yaml');

// UNCLOSの条文タイトル（日本語正文に基づく）
const UNCLOS_TITLES = {
  // 第一部 序
  1: '用語及び適用範囲',

  // 第二部 領海及び接続水域
  // 第一節 総則
  2: '領海、領海の上空並びに領海の海底及びその下の法的地位',
  3: '領海の幅',
  4: '領海の外側の限界',
  // 第二節 領海の限界
  5: '通常の基線',
  6: '礁',
  7: '直線基線',
  8: '内水',
  9: '河口',
  10: '湾',
  11: '港',
  12: '停泊地',
  13: '低潮高地',
  14: '基線を決定する方法の組合せ',
  15: '向かい合っているか又は隣接している海岸を有する国の間における領海の境界画定',
  16: '海図及び地理学的経緯度の表',
  // 第三節 領海における無害通航
  17: '無害通航権',
  18: '通航の意味',
  19: '無害通航の意味',
  20: '潜水船その他の水中航行機器',
  21: '無害通航に係る沿岸国の法令',
  22: '領海における航路帯及び分離通航帯',
  23: '外国の原子力船及び核物質又はその他の本質的に危険若しくは有害な物質を運搬する船舶',
  24: '沿岸国の義務',
  25: '沿岸国の保護権',
  26: '外国船舶に対して課し得る課徴金',
  27: '外国船舶内における刑事裁判権',
  28: '外国船舶に関する民事裁判権',
  29: '軍艦の定義',
  30: '軍艦による沿岸国の法令の違反',
  31: '軍艦又は非商業的目的のために運航するその他の政府船舶がもたらした損害についての旗国の責任',
  32: '軍艦及び非商業的目的のために運航するその他の政府船舶に与えられる免除',
  // 第四節 接続水域
  33: '接続水域',

  // 第三部 国際航行に使用されている海峡
  // 第一節 総則
  34: '国際航行に使用されている海峡を構成する水域の法的地位',
  35: 'この部の規定の適用範囲',
  36: '国際航行に使用されている海峡内の公海又は排他的経済水域の航路',
  // 第二節 通過通航
  37: 'この節の規定の適用範囲',
  38: '通過通航権',
  39: '通過通航中の船舶及び航空機の義務',
  40: '調査活動及び測量活動',
  41: '国際航行に使用されている海峡における航路帯及び分離通航帯',
  42: '通過通航に係る海峡沿岸国の法令',
  43: '航行及び安全のための援助施設及び他の改善措置並びに汚染の防止、軽減及び規制',
  44: '海峡沿岸国の義務',
  // 第三節 無害通航
  45: '無害通航',

  // 第四部 群島国
  46: '用語',
  47: '群島基線',
  48: '領海、接続水域、排他的経済水域及び大陸棚の幅の測定',
  49: '群島水域、群島水域の上空並びに群島水域の海底及びその下の法的地位',
  50: '内水の境界画定',
  51: '既存の協定、伝統的な漁業権及び既設の海底電線',
  52: '無害通航権',
  53: '群島航路帯通航権',
  54: '通過通航中の船舶及び航空機の義務、調査活動及び測量活動、海峡沿岸国の義務並びに海峡沿岸国の法令',

  // 第五部 排他的経済水域
  55: '排他的経済水域の特別の法制度',
  56: '排他的経済水域における沿岸国の権利、管轄権及び義務',
  57: '排他的経済水域の幅',
  58: '排他的経済水域における他の国の権利及び義務',
  59: '排他的経済水域における権利及び管轄権の帰属が条約によって定められていない場合における紛争の解決の基礎',
  60: '排他的経済水域における人工島、施設及び構築物',
  61: '生物資源の保存',
  62: '生物資源の利用',
  63: '二以上の沿岸国の排他的経済水域に出現する資源又は排他的経済水域と接続水域の双方に出現する資源',
  64: '高度回遊性の種',
  65: '海産哺乳動物',
  66: 'さく河性の種',
  67: '降河性の種',
  68: '定着性の種',
  69: '内陸国の権利',
  70: '地理的に不利な国の権利',
  71: '第六十九条及び第七十条の規定の不適用',
  72: '権利の移転についての制限',
  73: '沿岸国の法令の執行',
  74: '向かい合っているか又は隣接している海岸を有する国の間における排他的経済水域の境界画定',
  75: '海図及び地理学的経緯度の表',

  // 第六部 大陸棚
  76: '大陸棚の定義',
  77: '大陸棚に対する沿岸国の権利',
  78: '上部水域及び上空の法的地位並びに他の国の権利及び自由',
  79: '大陸棚における海底電線及び海底パイプライン',
  80: '大陸棚における人工島、施設及び構築物',
  81: '大陸棚における掘削',
  82: '二百海里を超える大陸棚の開発に関する支払及び拠出',
  83: '向かい合っているか又は隣接している海岸を有する国の間における大陸棚の境界画定',
  84: '海図及び地理学的経緯度の表',
  85: 'トンネルの掘削',

  // 第七部 公海
  // 第一節 総則
  86: 'この部の規定の適用',
  87: '公海の自由',
  88: '平和的目的のための公海の利用',
  89: '公海に対する主権についての主張の無効',
  90: '航行の権利',
  91: '船舶の国籍',
  92: '船舶の地位',
  93: '国際連合、その専門機関及び国際原子力機関の旗を掲げる船舶',
  94: '旗国の義務',
  95: '公海上の軍艦に与えられる免除',
  96: '政府の非商業的役務にのみ使用される船舶に与えられる免除',
  97: '衝突その他の航行上の事故に関する刑事裁判権',
  98: '援助を与える義務',
  99: '奴隷の運送の禁止',
  100: '海賊行為の抑止のための協力の義務',
  101: '海賊行為の定義',
  102: '乗組員が反乱を起こした軍艦、政府船舶又は政府航空機による海賊行為',
  103: '海賊船舶又は海賊航空機の定義',
  104: '海賊船舶又は海賊航空機の国籍の保持又は喪失',
  105: '海賊船舶又は海賊航空機の拿捕',
  106: '十分な根拠なしに拿捕が行われた場合の責任',
  107: '海賊行為を理由とする拿捕を行うことが認められる船舶及び航空機',
  108: '麻薬又は向精神薬の不正取引',
  109: '公海からの許可を得ていない放送',
  110: '臨検の権利',
  111: '追跡権',
  112: '海底電線及び海底パイプラインを敷設する権利',
  113: '海底電線又は海底パイプラインの損壊',
  114: '海底電線又は海底パイプラインの所有者による他の海底電線又は海底パイプラインの損壊',
  115: '海底電線又は海底パイプラインの損壊を避けるための損失に対する補償',
  // 第二節 公海における生物資源の保存及び管理
  116: '公海における漁獲の権利',
  117: '公海における生物資源の保存のための措置を自国民についてとる国の義務',
  118: '生物資源の保存及び管理における国の間の協力',
  119: '公海における生物資源の保存',
  120: '海産哺乳動物',

  // 第八部 島の制度
  121: '島の制度',

  // 第九部 閉鎖海又は半閉鎖海
  122: '定義',
  123: '閉鎖海又は半閉鎖海に面した国の間の協力',

  // 第十部 内陸国の海への出入りの権利及び通過の自由
  124: '用語',
  125: '海への出入りの権利及び通過の自由',
  126: '最恵国条項の適用除外',
  127: '関税、租税その他の課徴金',
  128: '自由地帯及び他の通関上の便益',
  129: '輸送手段の建設及び改善における協力',
  130: '通過運送における遅延又はその他の困難を回避し又は除去するための措置',
  131: '海港における同等の待遇',
  132: '通過のための一層大きい便益の供与',

  // 第十一部 深海底
  // 第一節 総則
  133: '用語',
  134: 'この部の規定の適用範囲',
  135: '上部水域及び上空の法的地位',
  136: '人類の共同の財産',
  137: '深海底及びその資源の法的地位',
  138: '深海底に関する国の一般的な行為',
  139: '遵守を確保する義務及び損害に対する責任',
  140: '人類の利益',
  141: '専ら平和的目的のための深海底の利用',
  142: '沿岸国の権利及び正当な利益',
  143: '海洋の科学的調査',
  144: '技術の移転',
  145: '海洋環境の保護',
  146: '人命の保護',
  147: '深海底における活動と海洋環境における活動との調整',
  148: '深海底における活動への開発途上国の参加',
  149: '考古学上の物及び歴史的な物',
  // 第二節 深海底を規律する原則
  150: '深海底における活動に関する方針',
  151: '生産政策',
  152: '機構による権限及び任務の行使',
  153: '探査及び開発の制度',
  154: '定期的な再検討',
  155: '再検討のための会議',
  // 第三節 深海底の資源の開発
  156: '機構の設立',
  157: '機構の性質及び基本原則',
  158: '機構の機関',
  // 第四節 総会
  159: '総会の構成、手続及び表決',
  160: '総会の権限及び任務',
  // 第五節 理事会
  161: '理事会の構成、手続及び表決',
  162: '理事会の権限及び任務',
  163: '理事会の機関',
  164: '経済企画委員会',
  165: '法律・技術委員会',
  // 第六節 事務局
  166: '事務局',
  167: '機構の職員',
  168: '事務局の国際的な性格',
  169: '国際機関及び非政府機関との協議及び協力',
  // 第七節 事業体
  170: '事業体',
  // 第八節 機構の財政的事項
  171: '機構の資金',
  172: '機構の年次予算',
  173: '機構の経費',
  174: '機構の借入れの権限',
  175: '年次監査',
  // 第九節 法的地位、特権及び免除
  176: '法的地位',
  177: '特権及び免除',
  178: '訴訟からの免除',
  179: '捜索及び強制執行からの免除',
  180: '規制、統制、行政上の制限等からの免除',
  181: '機構の文書及び職員の公式の通信',
  182: '機構と関係する者に関する特権及び免除',
  183: '租税及び関税の免除',
  // 第十節 深海底における活動の停止
  184: '議決権の停止',
  185: '権利及び特典の停止',
  // 第十一節 紛争の解決並びに勧告的意見
  186: '国際海洋法裁判所海底紛争裁判部',
  187: '海底紛争裁判部の管轄権',
  188: '第十一部の実施に関する紛争の付託',
  189: '機構の行為の合法性又は適正についての決定における制限',
  190: '契約当事者たる締約国又は機構のための参加及び出廷',
  191: '勧告的意見',

  // 第十二部 海洋環境の保護及び保全
  // 第一節 総則
  192: '一般的義務',
  193: '自国の天然資源を開発する国家の主権的権利',
  194: '海洋環境の汚染を防止し、軽減し及び規制するための措置',
  195: '損害又は危険を移転させ又は一の種類の汚染を他の種類の汚染に変えない義務',
  196: '技術の利用又は外来種若しくは新種の導入',
  // 第二節 世界的及び地域的協力
  197: '世界的又は地域的基礎における協力',
  198: '汚染による損害の差し迫ったおそれ又は実際の損害の通報',
  199: '汚染に対する緊急時の計画',
  200: '調査、研究計画及び情報及びデータの交換',
  201: '規則のための科学的基準',
  // 第三節 技術援助
  202: '開発途上国に対する科学的及び技術的援助',
  203: '開発途上国に対する優先的待遇',
  // 第四節 監視及び環境評価
  204: '汚染の危険又は影響の監視',
  205: '報告の公表',
  206: '活動が潜在的に与える影響の評価',
  // 第五節 海洋環境の汚染を防止し、軽減し及び規制するための国際的規則及び国内法令
  207: '陸にある発生源からの汚染',
  208: '海底における活動からの汚染',
  209: '深海底における活動からの汚染',
  210: '投棄による汚染',
  211: '船舶からの汚染',
  212: '大気からの又は大気を通じての汚染',
  // 第六節 執行
  213: '陸にある発生源からの汚染に関する執行',
  214: '海底における活動からの汚染に関する執行',
  215: '深海底における活動からの汚染に関する執行',
  216: '投棄による汚染に関する執行',
  217: '旗国による執行',
  218: '寄港国による執行',
  219: '船舶の堪航性に関する汚染回避措置',
  220: '沿岸国による執行',
  221: '海難から生ずる汚染を避けるための措置',
  222: '大気からの又は大気を通じての汚染に関する執行',
  // 第七節 保障措置
  223: '執行措置を容易にするための措置',
  224: '執行権限の行使',
  225: '執行権限の行使に当たって悪影響を避ける義務',
  226: '外国船舶に対する調査',
  227: '外国船舶を差別しないこと',
  228: '手続の停止及び手続の開始に係る制限',
  229: '民事上の手続の開始',
  230: '金銭罰及び被告人の認められた権利の尊重',
  231: '旗国及び関係国への通報',
  232: '執行措置から生ずる国の責任',
  233: '国際航行に使用されている海峡に関する保障措置',
  // 第八節 氷に覆われた水域
  234: '氷に覆われた水域',
  // 第九節 責任
  235: '責任',
  // 第十節 主権免除
  236: '主権免除',
  // 第十一節 他の条約に基づく義務
  237: '他の条約に基づく義務',

  // 第十三部 海洋の科学的調査
  // 第一節 総則
  238: '海洋の科学的調査を実施する権利',
  239: '海洋の科学的調査の促進',
  240: '海洋の科学的調査の実施のための一般原則',
  241: '権利の主張の法的根拠としての海洋の科学的調査の活動の否認',
  // 第二節 国際協力
  242: '国際協力の促進',
  243: '好条件の創出',
  244: '情報及び知識の公表及び頒布',
  // 第三節 海洋の科学的調査の実施及び促進
  245: '領海における海洋の科学的調査',
  246: '排他的経済水域及び大陸棚における海洋の科学的調査',
  247: '国際機関により又は国際機関の支援の下に実施される海洋の科学的調査計画',
  248: '沿岸国に対する情報の提供義務',
  249: '一定の条件を遵守する義務',
  250: '海洋の科学的調査計画に関する通報',
  251: '一般的基準及び指針',
  252: '黙示の同意',
  253: '海洋の科学的調査活動の停止又は終了',
  254: '隣接する内陸国及び地理的に不利な国の権利',
  255: '海洋の科学的調査を容易にし及びその調査船を援助するための措置',
  256: '大陸棚の二百海里を超える部分における海洋の科学的調査',
  257: '排他的経済水域の外側の水域における海洋の科学的調査',
  // 第四節 海洋環境における科学的調査のための施設又は機材
  258: '施設又は機材の設置及び利用',
  259: '法的地位',
  260: '安全水域',
  261: '国際航行を妨害しないこと',
  262: '識別及び警告のための信号の表示',
  // 第五節 責任
  263: '責任',
  // 第六節 紛争の解決並びに暫定措置
  264: '紛争の解決',
  265: '暫定措置',

  // 第十四部 海洋技術の発展及び移転
  // 第一節 総則
  266: '海洋技術の発展及び移転の促進',
  267: '正当な利益の保護',
  268: '基本的目標',
  269: '基本的目標を達成するための措置',
  // 第二節 国際協力
  270: '国際協力のための方法及び手段',
  271: '指針、基準及び標準',
  272: '国際的な計画の調整',
  273: '国際機関及び機構との協力',
  274: '機構の目的',
  // 第三節 海洋科学技術センター
  275: '海洋科学技術センターの設立',
  276: '地域センターの設立',
  277: '地域センターの任務',
  // 第四節 国際機関間の協力
  278: '国際機関間の協力',

  // 第十五部 紛争の解決
  // 第一節 総則
  279: '平和的手段による紛争の解決の義務',
  280: '当事者が選択する平和的手段による紛争の解決',
  281: '当事者間の合意によっても解決が得られなかった場合の手続',
  282: '一般的な、地域的な又は二国間の協定に基づく義務',
  283: '意見の交換をする義務',
  284: '調停',
  285: '第十一部第五節に基づく紛争に対するこの節の規定の適用',
  // 第二節 拘束力を有する決定を伴う義務的手続
  286: 'この節に規定する手続の適用',
  287: '手続の選択',
  288: '管轄権',
  289: '専門家',
  290: '暫定措置',
  291: '当事者適格及び出廷',
  292: '船舶及び乗組員の迅速な釈放',
  293: '適用すべき法',
  294: '先決的手続',
  295: '地方的な救済の完了',
  296: '決定の最終性及び拘束力',
  // 第三節 第二節に規定する手続の適用についての制限及び例外
  297: '第二節に規定する手続の適用についての制限',
  298: '第二節に規定する手続の適用からの選択的除外',
  299: '当事者が紛争を付託することについて合意する権利',

  // 第十六部 一般規定
  300: '信義誠実の原則及び権利の濫用',
  301: '海洋の平和的利用',
  302: '情報の開示',
  303: '海で発見された考古学上の物及び歴史的な物',
  304: '損害又は損失についての責任',

  // 第十七部 最終規定
  305: '署名',
  306: '批准及び正式確認',
  307: '加入',
  308: '効力発生',
  309: '留保及び例外',
  310: '宣言',
  311: '他の条約及び国際協定との関係',
  312: '改正',
  313: '簡易な手続による改正',
  314: '深海底に関する規定の改正',
  315: '深海底に関する規定の改正についての署名、批准、加入及び改正正文',
  316: '改正の効力発生',
  317: '廃棄',
  318: '附属書の地位',
  319: '寄託者',
  320: '正文',
};

// UNCLOSディレクトリのパス
const unclosDir = path.join(__dirname, '../../src/data/laws/treaty/unclos');

// メイン処理
function main() {
  console.log('='.repeat(60));
  console.log('国連海洋法条約 YAMLファイル タイトル更新スクリプト');
  console.log('='.repeat(60));

  let updated = 0;
  let skipped = 0;
  let errors = 0;

  for (const [articleNum, title] of Object.entries(UNCLOS_TITLES)) {
    const filename = `${articleNum}.yaml`;
    const filepath = path.join(unclosDir, filename);

    try {
      // ファイルが存在するか確認
      if (!fs.existsSync(filepath)) {
        console.log(`  ${filename} が存在しません`);
        skipped++;
        continue;
      }

      // YAMLファイルを読み込み
      const content = fs.readFileSync(filepath, 'utf8');
      const data = yaml.load(content);

      // タイトルを更新
      const oldTitle = data.title;
      data.title = `第${articleNum}条 ${title}`;

      // YAMLファイルを書き込み
      const newContent = yaml.dump(data, {
        lineWidth: -1,
        noRefs: true,
        quotingType: "'",
        forceQuotes: false,
      });

      fs.writeFileSync(filepath, newContent, 'utf8');

      if (oldTitle !== data.title) {
        console.log(`[OK] ${filename}: ${oldTitle} -> ${data.title}`);
        updated++;
      } else {
        skipped++;
      }
    } catch (error) {
      console.error(`[NG] ${filename}: エラー - ${error.message}`);
      errors++;
    }
  }

  console.log('\n' + '='.repeat(60));
  console.log(`完了: 更新 ${updated}件, スキップ ${skipped}件, エラー ${errors}件`);
  console.log('='.repeat(60));
}

main();
