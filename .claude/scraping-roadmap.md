# スクレイピングロードマップ

全38法律・8,283条のデータ取得計画

## 📊 現状（2025-11-11時点）

- **Stage 1（原文取得）完了**: 5,253/8,283条（**63.4%**）
- **完成済み法律**:
  - **日本現行法**: 日本国憲法（103条）、民法（1,360条）、商法（457条）、会社法（1,152条）、刑法（356条）、民事訴訟法（540条）、刑事訴訟法（815条）、AI基本法（1条）
  - **日本歴史法**: 十七条憲法（17条）
  - **外国現行法**: アメリカ憲法（34条）、ドイツ基本法（198条）、中国憲法（143条）
  - **外国歴史法**: マグナ・カルタ（63条）
  - **国際条約**: 南極条約（14条）

**注**: 附則・経過規定を含むため、計画条文数より実際の取得数が多い場合があります。

---

## 🎯 5段階ロードマップ

### 📅 Phase 1: 日本現行法（六法）- ✅ **完了**

**対象**: 4,055条 → **実際: 4,680条取得**（附則含む）

| 法律       | 計画条文数 | 実際取得数 | e-Gov法令番号   | 状態    |
| ---------- | ---------- | ---------- | --------------- | ------- |
| 民法       | 1,050      | 1,360      | 129AC0000000089 | ✅ 完了 |
| 商法       | 851        | 457        | 132AC0000000048 | ✅ 完了 |
| 会社法     | 979        | 1,152      | 417AC0000000086 | ✅ 完了 |
| 刑法       | 264        | 356        | 140AC0000000045 | ✅ 完了 |
| 民事訴訟法 | 404        | 540        | 408AC0000000109 | ✅ 完了 |
| 刑事訴訟法 | 507        | 815        | 323AC0000000131 | ✅ 完了 |

**実行方法**:

```bash
npm run fetch:roppou
```

**所要時間**: 約93秒（実測）

**達成効果**: Stage 1が 2.4% → **58.9%**（+56.5%）

**優先度**: ✅ **完了**

---

### 📅 Phase 2: 外国現行法 - ✅ **完了**

**対象**: 318条 → **実際: 375条取得**

**実装したスクリプト**:

1. ✅ `scripts/fetch-us-constitution.js`（完成）
2. ✅ `scripts/fetch-german-basic-law.js`（完成）
3. ✅ `scripts/fetch-china-constitution.js`（完成）

| 法律         | 計画条文数 | 実際取得数 | データソース                 | 状態    |
| ------------ | ---------- | ---------- | ---------------------------- | ------- |
| アメリカ憲法 | 34         | 34         | archives.gov                 | ✅ 完了 |
| ドイツ基本法 | 146        | 198        | gesetze-im-internet.de (XML) | ✅ 完了 |
| 中国憲法     | 138        | 143        | gov.cn                       | ✅ 完了 |

**達成効果**: Stage 1が 58.9% → **63.4%**（+4.5%）

**優先度**: ✅ **完了**

---

### 📅 Phase 3: 主要国際条約 - 🔄 **進行中**

**対象**: 約600条

**現状**: 南極条約（14条）のみ完了

**実装順序**（優先度順）:

1. ⏳ WHO憲章（82条）- WHO公式（データソース確認中）
2. ⏳ 国連憲章（111条）- 外務省/国連
3. ⏳ 国連海洋法条約（320条）- 外務省
4. ⏳ シカゴ条約（96条）- ICAO公式
5. ⏳ オリンピック憲章（60条）- IOC公式（スキップ検討中）
6. ⏳ NPT（11条）- 外務省
7. ⏳ 宇宙条約（17条）- UNOOSA
8. ⏳ ラムサール条約（12条）- ramsar.org
9. ⏳ その他の小規模条約

**課題**:

- 外部サイトへのネットワークアクセスが不安定
- HTMLスクレイピングが必要な条約が多い
- PDF形式のデータが多く、テキスト抽出が必要

**データソース**:

- 外務省: https://www.mofa.go.jp/
- 国連条約DB: https://treaties.un.org/
- 各国際機関公式サイト

**期待効果**: Stage 1が 63.4% → **70%台**（+7-10%）

**優先度**: ⭐⭐⭐⭐（現在の最優先フェーズ）

---

### 📅 Phase 4: 歴史法・外国歴史法 - 中長期実装（1-2ヶ月）

**対象**: 約742条

#### 日本歴史法（192条）

**実装順序**:

1. 五箇条の御誓文（5条）- 手動入力
2. 武家諸法度（13条）- 半自動
3. 禁中並公家諸法度（17条）- 半自動
4. 大宝律令（30条）- スクレイピング
5. 御成敗式目（51条）- スクレイピング
6. 明治憲法（76条）- スクレイピング

**データソース**: 国立国会図書館デジタルコレクション

#### 外国歴史法（550条）

**実装順序**:

1. 権利章典（13条）- legislation.gov.uk
2. ハンムラビ法典（282条）- Yale Avalon Project
3. ワイマール憲法（181条）- documentarchiv.de
4. ローマ法大全（50条・抜粋）- 選定が必要

**期待効果**: Stage 1が 62.5% → **71.5%**（+9.0%）

**優先度**: ⭐⭐⭐

---

### 📅 Phase 5: 残りの条約・歴史法 - 長期プロジェクト（3-6ヶ月）

**対象**: 約2,781条

**最大の課題**:

- ナポレオン法典（2,281条）- 全体の27%を占める
- 多言語対応が必要（フランス語原文）

**その他の国際条約**:

- ラムサール条約（12条）
- NPT（11条）
- 宇宙条約（17条）
- 万国郵便条約（40条）
- メートル条約（18条）
- ITU憲章（59条）
- 日米犯罪人引渡条約（21条）
- その他

**期待効果**: Stage 1が 71.5% → **100%**（+28.5%）

**優先度**: ⭐⭐

---

## 🛠️ 技術的な実装方針

### ✅ 既に実装済み

- e-Gov API対応スクリプト（六法用）✅
- HTMLスクレイピング（cheerio）✅
- XMLパース（xml2js）✅
- プロキシ対応✅
- リトライ機能✅
- エラーハンドリング✅
- 進捗管理システム（YAML）✅
- 六法一括取得スクリプト✅
- 外国憲法スクレイパー（米・独・中）✅

### 🔧 実装が必要

1. **PDF解析**（高優先度）
   - 一部の条約・歴史法はPDFのみ提供
   - `pdf-parse`等のライブラリ導入検討
   - テキスト抽出と条文パース

2. **ネットワーク安定性の改善**
   - WebFetchツールの不安定性対策
   - ローカルダウンロード→解析パターン
   - キャッシュ機能

3. **汎用条約スクレイパー**
   - 外務省フォーマット対応
   - 国連条約DB対応
   - 各国際機関フォーマット対応

4. **歴史法スクレイパー**
   - 国会図書館デジタルコレクション対応
   - 古文書フォーマット対応

---

## 📈 進捗可視化

進捗は以下で確認可能：

1. **YAMLファイル**: `.claude/all-laws-progress.yaml`
2. **Webページ**: `/progress`（実装済み）
3. **CLI**: `npm run fetch:roppou` 実行時のログ

---

## 🚀 次のアクションアイテム

### Phase 3: 国際条約の取得

**課題**: ネットワークアクセスが不安定なため、以下の対策が必要：

1. **外務省の条約ページから取得**（日本語・安定）
   - NPT（11条）
   - 宇宙条約（17条）
   - その他外務省掲載条約

2. **PDF解析ツールの導入**
   - `pdf-parse`や類似ライブラリ
   - IOC、WHO、ICAOなどはPDF提供が多い

3. **国連条約DBの活用**
   - 構造化されたデータ
   - 多言語対応

### 次に実装するスクリプト（優先順）

1. ✅ `scripts/fetch-us-constitution.js`（完成）
2. ✅ `scripts/fetch-german-basic-law.js`（完成）
3. ✅ `scripts/fetch-china-constitution.js`（完成）
4. ⏳ `scripts/fetch-treaty.js`（汎用・未実装）
5. ⏳ `scripts/fetch-historical-law.js`（日本歴史法用・未実装）

---

## 📝 注意事項

### データ取得時の礼儀

- **リクエスト間隔**: 最低1秒以上
- **User-Agent**: 適切に設定済み
- **robots.txt**: 遵守すること
- **利用規約**: 各サイトの規約を確認

### プロキシ設定

プロキシが必要な環境の場合：

```bash
export HTTPS_PROXY=http://proxy.example.com:8080
export HTTP_PROXY=http://proxy.example.com:8080
```

### エラー対応

- **タイムアウト**: リトライ機能で自動対応
- **API制限**: レート制限で自動調整
- **ネットワークエラー**: 個別に再実行可能

---

## 📊 最終目標

**全38法律・8,283条のStage 1（原文取得）を100%完成させる**

完成後：

- Stage 2: 原文解説作成
- Stage 3: 大阪弁訳作成
- Stage 4: 大阪弁解説作成

へと進む。
